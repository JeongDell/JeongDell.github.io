---
layout: post
title:  "통계 101 데이터분석"
published: true
date:   2024-09-24 05:50:00
categories: ST(Statics)
permalink: /ST/2
--- 

# 다양한 가설검정

## 가설검정 흐름
1. 확인하고 싶은 대상에 따라 귀무가설과 대립가설을 설정한다
2. 데이터로 가설검정에 따라 필요한 검정통계량을 계산한다
3. 귀무가설이 옳다는 가정하에 통계학의 분포를 생각하고, 데이터로 계산한 통계량이 분포의 어느 위치에 있는지를 구하여 p값을 계산한다

## 데이터 유형

![image](https://github.com/user-attachments/assets/7f3e4845-38d8-4790-8557-343788029244)

- 왼쪽: 범주형데이터 마다 양적 데이터가 달라지는지 조사할 때
- 가운데: 범주형 데이터끼리의 관계를 조사할 때
오른쪽: 양적 데이터끼리의 관계를 조사할 때

## 표본의 수

1표본의 경우
- 1변수 데이터 조사
- 특정 1개의 모집단분포에 대해 세운 가설을 검증

2표본의 경우
- 집단 간의 차이를 조사

3표본의 경우
- 다중비교 사용(보정필요)

## 양적변수의 성질
- <b> 어떤 분포를 취하는지</b>가 검정방법을 선택할 때 중요

- 모수검정   
  - 모집단이 수학적으로 다룰 수 있는(파라미터로 설명할 수 있는) 특정 분포를 따룬다는 가정을 둔 가설검정
  - 대부분 데이터가 정규분포인 경우(정규성을 가지는 경우)

- 비모수검정
   - 평균이나 표준편차 등의 파라미터에 기반을 두지 않는 방법
   - ex) 좌우비대칭 분포, 이상악ㅄ이 있는 분포 등

- 등분산성
   -  집단 간 평균값을 비교하는 경우, 집단끼리 분산이 동일하다고 가정하는 방법


![image](https://github.com/user-attachments/assets/566220fc-8a48-4b94-a5a2-9ee7338dc986)

# 대푯값 비교

## 일표본 t검정

![image](https://github.com/user-attachments/assets/719745fc-df3b-4c04-8089-9688feb6a15a)

- 분석결과 a=0.05에서 p>=0.05면 귀무가설 채택
- p<0.05면 대립가설 채택

단 모집단의 평균은 연구의 배경으로서 의미가 있는 값을 고려할 것

- 한국인 성인 남성의 평균 키는 170cm이다 :X
   - 이 경우에서는 95% 신뢰구간 사용

- 중국인 성인 남성의 평균키 =170을 아는 상태에서 한국인 성인 남성의 평균 키는 170cm이다: O
   
![image](https://github.com/user-attachments/assets/d6e9871c-b21a-43f2-bd25-8d233b830656)


마지막에 모집단 평균값을 대입해서 구체적인 95% 범위 계산
- 이 범위에 포함되지 않는 극단적인 값이 나타날 확률이 P<0.05

## 이표본 t 검정

![image](https://github.com/user-attachments/assets/9201be78-a46e-4767-a569-0516b566b849)

- t검정은 모수검정으로 분류되는 검정 방법이기 때문에 데이터에 정규성이 있어야 함

- 일반적으로는 등분산성 가정

- 분산이 일치하지 않는 경우 웰치의 t검정을 이용

## 대응 관계 없는 검정과 대응 관계가 있는 검정

- 대응관계가 없다: 신약 검증에서 모집군을 2개로 나눌 경우

- 대응관계까 존재한다: 신약 검증에서 한 피험자에 대해 신약을 복용 하기 전과 후의 데이터를 비교하는 경우
   - 일뵤폰 t검정을 사용하여, 차이 평균값=0을 귀무가설로 해석하는 것이 가능
   - 대응 관계가 있는 데이터는 똑같이 대응관계까 있는 검정을 이용하는 것이 좋음    
       - 2종 오류를 막고, 검정력도 올릴 수 있음

## 정규성 조사

1. Q-Q플롯(분위수-분위수 그림): 시각적으로 판단 가능

2. 사피로-월크 검정: 가설검정으로 조사

3. 콜모고르프-스미르노프(K-S)검정: 이론적인 분포와 비교

> 귀무가설: 모집단이 정규분포이다
> 대립가설: 모집단이 정규분포가 아니다
- p>0.05면 귀무가설 채택, 아니면 정규성이 없다고 판단
- 단 p>0.05라 귀무가설을 기각할 수 없다고 귀무가설이 옳다는 증거가 되지는 않는 다는 것에 주의

- 2개 집단ㅇ이 있을 때는 각 집단의 정규성 조사 후 t검정을 실시하므로, 다중성 문제가 발생함에 주즤

## 등분산성 조사

- 바틀렛 검정이나 레빈 ㄱ머정 사용

> 귀무가설: 2개 모집단의 분산이 같다
> 대립가설: 2개 모집단의 분산이 같지 않다

- 이후 p-test 진행

## 비모수검정의 대표값 비교
-각 집단에 정슈성이 ㅇ벗는 경우 비모수검정 사용 권장
> 월콕슨 순위합 검정 사용
   - 평균값 대신 각 데이터 값의 순위(크기 순 나열시 몇번 째 위치인가)에 기반하여 검정을 실시

> 귀무가설: 2개 모집단의 위차가 같다
> 대립가설: 2개 모집단의 위치가 같지 않다

![image](https://github.com/user-attachments/assets/58385af8-3cda-47bf-a739-228cf4032adf)


## 분산 분석(3개 집단 이상의 평균값 비교)

![image](https://github.com/user-attachments/assets/7565a389-2a9f-4467-a483-c53568e7c675)


![image](https://github.com/user-attachments/assets/7d5d059d-6df1-454b-bf36-4c11cf9d1664)

F값 = (평균적인 집단 간 변동)/(평균적인 집단 내 변동)을 사용하여 검정통계량을 생성
- 귀무가설이 올바르다는 가정하에 F분포를 따름
   -  p값 =  F값 이상의 극단적인 값이 나올 확률


## 이항검정
- 하나의 범주가 확률 P, 또 하나의 범주가 확률 1-P로 나타나는지 조사

## 카이제곱검정: 적합도 검정

> 귀무가설: 모집단은 상정한 이산확률분포이다
> 대립가설: 모집단은 상정한 이산확률분포가 아니다

- 귀무가설의 확률분포에서 얻을 수 잇는 기대도수를 계산
   - 기대도수: 전체 개수 * 확률

이후 (실제 출현도수-기대도수)^2/(기대도수)를 계산하고, 이를 더한 값을 구함 : 카이제곱값

- 카이 제곱값의 위치를 구하여 p값을 도출
![image](https://github.com/user-attachments/assets/c7d2a74c-8867-4e85-bd93-bc5db6b6e299)

## 카이제곱검정: 독립성 검정

> 귀무가설: 2개의 변수는 독립이다
> 대립가설: 2개의 변수는 독립이 아니다

- (실제 출현도수-기대도수)^2/(기대도수)를 계산

![image](https://github.com/user-attachments/assets/5af2b3d1-18a0-456c-beba-453ac416ca69)


# 상관과 회귀

## 상관
- 2개 확률 변수 또는 데이터 사이의 관계성
- 인과관계 여부는 알 수 없음에 주의

![image](https://github.com/user-attachments/assets/c886a1fe-c846-425d-97ec-2ce3b57ace30)

## 회귀
- y=f(x)를 통해 변수 사이의 관계를 공식화

   - x: 독립변수(설명변수)
   - y: 종속변수(반응변수)


## 상관관계

- 피어슨 상관계수(r): 2개 양적 변수 사이의 선형관계가 얼마나 진선 관계에 가까운가?

![image](https://github.com/user-attachments/assets/06ea70ba-edde-492f-87ae-20686f6512ac)

- 단 곡선과 같은 비선형 관계는 적절하게 정량화 할 수 ㅇ벗음
- 기울기와 r은 연관이 없음

- 정규성 검사: 데이터가 찌그러지거나, 쌍봉형이거나, 이상값이 있으면 r값이 크게 변하므로 정규성을 확인하고 피어슨 상관계쑤 또는 스피어만 순위상관계수 중 무엇을 사용할지 결정

## 비모수 상관계수

- 스피어만 순위상관계수(p): x,y 중 적어도 하나에 정규성이 없을 때 사용
   - 양적 제기어 갑싱 아니라, 그 데이터의 값을 x,y축에서 크기 순으로 나열했을 때 순위로 변형하고 아래의 식을 사용하여 계산

![image](https://github.com/user-attachments/assets/b27eb6b7-08e5-4cc1-bb31-d5d373b5217b)

## 상관관게 사용시 주의 점
- 2개 변수가 처음부터 종속 관계일 경우 사용에 주의    

   - x,y 축의 갓이 개별 변수 일것
   - 나눗셈 등으로 변환하지 않았을 것 등 확인

## 상관계수와 가설

상관계쑤 r의 배경으로 상관계수 rp를 갖는 모집단 분포를 생각해보자

![image](https://github.com/user-attachments/assets/d2f60526-552e-4fdd-9ca1-043e989263ba)

여기서 rp의 유의성 검정을 실시힌다
>귀무가설: rp=0
>대립가설: rp는 0이 아니다

- 이후 p 값을 계산하고, p값에 따라 상관계수가 유의한지 아닌지를 판단한다

- 표본크기 n이 커길수록 모집단이 귀무가설에서 아조 조금만 어긋나도 p값이 0.05보다 쉽게 작이지므로 r값 자체의 크기를 해석해야한다

![image](https://github.com/user-attachments/assets/0166ad62-c3f2-4ea8-9e20-7d80c5300f49)

## 비선형상관

- X가 Y에 관해, 또는 Y가 X에 관해 어느 정도의 정보를 포함하는지의 관점에서 관계성 강도를 정량화


## 선형회귀

선형 회귀 모델은 아래의 식으로 나타내진다
![image](https://github.com/user-attachments/assets/d9f5f0e1-1945-4748-8f17-70b754c9f159)

각 데이터는 아래의 식으로 나타낸다
![image](https://github.com/user-attachments/assets/2c8487a9-dc6b-4751-9645-813a42c35637)

선형회귀 모델을 실행할 때 아래에 유의한다
- 어떤 회귀식을 적용할 것인가?
- 어떻게 회귀슥을 데이터에 적용할 것인가?
- 얻은 회귀모형을 어떻게 평가할 것인가?

## 최소제곱법
- 잔차 제곱의 총합이 최소가 되도록 하는 회귀식의 a,b를 구하는 방법

## 회귀계수

- 최소제곱법으로 얻은 선형회귀 파라미터(a^,b^)은 모집단의 파리미터(a,b)의 비편향 추정량이 됨

![image](https://github.com/user-attachments/assets/0708d712-6b17-4639-a7e8-f96b6df12269)

- 최량선형비편향추정량: 분산이 일정하다는 가정에서 최소제곱버으로 얻은 추정량은 비편향추정량 중에서도 가장 절밀도가 높은 비편향 추정량이 됨

## 회귀 계수와 가설 검정

- 기울기 b를 이용하여 가설검정을 실시
> 귀무가설: b=0
> 대립가설: b는 0이 아니다

이후 p값으로 b의 유의성 판단
- a에 대해서는 해석하지 않는다

## 95%신뢰구간

- 동일한 방법으로 표본추출과 회귀 분석을 100번 시행했더니, 100번 중 95번 정도는 이 범위에 모집단의 모형이 포함되었다

![image](https://github.com/user-attachments/assets/c25f8e87-93c2-4c87-8c90-ce3bdbb57302)

## 95% 예측구간

- 예측구간: 추정한 회귀 모형을 기만으로 데이터 그 자체가 분포하는 구간을 그린 것
- 95%예측구간은 얻을 수 있는 데이터의 95%를 포함하는 범위

![image](https://github.com/user-attachments/assets/24b3c092-03a1-4b16-990c-0b1db9df13ed)

## 결정계수(R^2)

- 회귀식이 잘 들어 맞는지 평가하는 지표
 
 ![image](https://github.com/user-attachments/assets/ec24efa7-c5a4-4c4d-ac8a-172fc5d02f57)

![image](https://github.com/user-attachments/assets/69cb944e-99a5-4162-a907-968379ef76be)

- 조정 결정계수: 결정 계수는 설명 변수의 개수가 늘어날수록 커지는 성질 이 있으므로 결정계수를 조정

![image](https://github.com/user-attachments/assets/5438d24a-d1ee-4e86-9d5e-a9011533de99)

- 설명변수가 적을수록 결정계수와 거의 비슷한 값이 됨

- 잘 들어맞지 안흔 모형으로 결정계수를 계산하면 값이 음수가 될 수 있음에 주의

## 오차의 등분산성
- 최소제곱법으로 구한 선형 모델의 파라미터를 대상으로 가설검정을 시행하거나 신뢰구간을 얻기 위해서는 오차항의 환률 분포가 평균이 0, 분산이 시그마인 정규 분포라고 가정해야 함

- 샤피로-월크 검정을 통해 데이터와 모형의 차이인 잔치의 정규성을 확인

![image](https://github.com/user-attachments/assets/34339648-ce0d-43cc-8969-bf3d3cd4ee30)

## 설명변수와 반응 변수

1. 한쪽 변수로 다른 쪽의 변수를 설명하고 할 때

- 설명하는 쪽을 설명 변수로, 설명할 대상을 반응변수로 설정

2. 인과관계를 알고 싶을 때
- 원인을 설명변수로, 결과를 반응변수로 설정
- 설명 변수를 무작위로 할당한 개입 실험에서 얻은 데이터나, 상정할 수 있는 다른 요인도 포함한 다중회귀분석 모형등을 이용

3. 데이터를 예측하고 싶을 때
- 예측의 근거를 설명 변수, 예측하고자 하는 변수를 반응 변수로 설정